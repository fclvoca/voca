function doGet() {
  return HtmlService.createHtmlOutputFromFile('fcl_voca3')
    .setTitle('FCL 고등 필수 영단어')
    .setXFrameOptionsMode(HtmlService.XFrameOptionsMode.ALLOWALL)
    .addMetaTag('viewport', 'width=device-width, initial-scale=1');
}

function getWordsFromSheet() {
  // 실제 선생님의 구글 시트 ID를 여기에 입력하세요.
  const spreadsheetId = '여기에_실제_시트_ID를_복사해서_넣으세요';
  const sheetName = 'words';
  
  try {
    const ss = SpreadsheetApp.openById(spreadsheetId);
    const sheet = ss.getSheetByName(sheetName);
    const range = sheet.getDataRange();
    const values = range.getValues();
    
    // 제목행(첫 번째 줄)을 제외하고 데이터 추출
    const data = [];
    for (let i = 1; i < values.length; i++) {
      if (values[i][0]) { // A열(영어)에 내용이 있는 경우만 포함
        data.push({
          english: values[i][0],
          pronunciation: values[i][1] || '',
          korean: values[i][2] || ''
        });
      }
    }
    return data;
  } catch (e) {
    return "Error: " + e.toString();
  }
}
