<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Academic English Master</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;700;900&display=swap');
        :root { --fcl-navy: #1A237E; --fcl-orange: #FF9800; --fcl-red: #EF4444; --fcl-green: #2ECC71; --fcl-bg: #F5F7F9; }
        
        body { font-family: 'Noto Sans KR', sans-serif; background: var(--fcl-bg); margin: 0; padding: 0; overscroll-behavior-y: contain; }
        .header { position: sticky; top: 0; z-index: 1000; background: var(--fcl-navy); padding: 15px; box-shadow: 0 2px 10px rgba(0,0,0,0.2); }
        .top-row { display: flex; align-items: center; gap: 10px; margin-bottom: 12px; }
        .title-area { flex: 1; color: white; font-weight: 900; font-size: 18px; }
        .speed-container { flex: 1; display: flex; align-items: center; background: rgba(255,255,255,0.1); padding: 0 10px; border-radius: 8px; height: 45px; gap: 8px; }
        .speed-label { color: white; font-size: 11px; font-weight: bold; white-space: nowrap; }
        .speed-slider { flex: 1; cursor: pointer; accent-color: var(--fcl-orange); }
        .btn-gear { background: none; border: none; color: rgba(255,255,255,0.5); font-size: 22px; cursor: pointer; }
        
        .btn-row { display: flex; gap: 8px; }
        .btn-main { flex: 1; height: 45px; border: none; border-radius: 8px; color: white; font-weight: bold; cursor: pointer; font-size: 15px; }

        .word-item { background: white; margin: 10px; padding: 18px; border-radius: 12px; display: flex; align-items: center; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
        .check { width: 24px; height: 24px; border: 2px solid #ddd; border-radius: 50%; margin-right: 15px; flex-shrink: 0; }
        .check.active { background: var(--fcl-red); border-color: var(--fcl-red); }
        .eng-box { flex: 1; cursor: pointer; }
        .eng { font-weight: 900; font-size: 20px; line-height: 1.2; display: block; }
        .pro { color: #888; font-size: 14px; margin-top: 4px; display: block; }
        .kor { background: #f0f4f8; padding: 10px; border-radius: 8px; font-weight: 700; min-width: 90px; text-align: center; cursor: pointer; font-size: 16px; }
        .kor.hidden { color: transparent; background: #e2e8f0; }

        #adminPanel { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: white; z-index: 2000; padding: 20px; box-sizing: border-box; overflow-y: auto; }
        .admin-box { border: 1px solid #ddd; padding: 15px; border-radius: 10px; margin-bottom: 20px; }
        .admin-input { width: 100%; padding: 12px; margin-bottom: 10px; border: 1px solid #ddd; border-radius: 5px; box-sizing: border-box; }
    </style>
</head>
<body onclick="unlockAudio()">

<div class="header">
    <div class="top-row">
        <div class="title-area">High School Voca</div>
        <div class="speed-container">
            <span class="speed-label">ì†ë„</span>
            <input type="range" id="speechRate" class="speed-slider" min="0.5" max="1.5" step="0.1" value="1.0">
        </div>
        <button onclick="askAdmin()" class="btn-gear">âš™ï¸</button>
    </div>
    <div class="btn-row">
        <button onclick="toggleShuffle()" id="shuffleBtn" class="btn-main" style="background:var(--fcl-green)">ìˆœì„œ ì„ê¸°</button>
        <button onclick="toggleFocus()" id="focusBtn" class="btn-main" style="background:var(--fcl-red)">ì§‘ì¤‘ ì•”ê¸°</button>
        <button onclick="toggleHide()" class="btn-main" style="background:var(--fcl-orange)">ëœ» ìˆ¨ê¸°ê¸°</button>
    </div>
</div>

<div id="display"></div>

<div id="adminPanel">
    <h2 style="margin-top:0;">âš™ï¸ ë‹¨ì–´ì¥ ê´€ë¦¬ ì‹œìŠ¤í…œ</h2>
    
    <div class="admin-box">
        <div style="font-weight:bold; margin-bottom:5px;">ğŸ“Š ë“±ë¡ ë‹¨ì–´ í†µê³„</div>
        <div id="statBox" style="font-size:24px; font-weight:900; color:var(--fcl-navy);">í™•ì¸ ì¤‘...</div>
    </div>

    <div class="admin-box">
        <div style="font-weight:bold; margin-bottom:10px;">â• ìƒˆë¡œìš´ ë‹¨ì–´ ì¶”ê°€</div>
        <input type="text" id="addEng" class="admin-input" placeholder="ì˜ë‹¨ì–´">
        <input type="text" id="addPro" class="admin-input" placeholder="ë°œìŒ ê¸°í˜¸">
        <input type="text" id="addKor" class="admin-input" placeholder="í•œê¸€ ëœ»">
        <button onclick="manageWord('add')" style="width:100%; padding:15px; background:var(--fcl-green); color:white; border:none; border-radius:8px; font-weight:bold;">ì‹œíŠ¸ì— ì¶”ê°€í•˜ê¸°</button>
    </div>

    <div class="admin-box">
        <div style="font-weight:bold; margin-bottom:10px;">ğŸ”„ ë‹¨ì–´ ì´ë¦„ ìˆ˜ì •</div>
        <input type="text" id="oldName" class="admin-input" placeholder="ê¸°ì¡´ ë‹¨ì–´ëª…">
        <input type="text" id="newName" class="admin-input" placeholder="ìƒˆ ë‹¨ì–´ëª…">
        <button onclick="manageWord('modify')" style="width:100%; padding:15px; background:var(--fcl-orange); color:white; border:none; border-radius:8px; font-weight:bold;">ì´ë¦„ ìˆ˜ì •í•˜ê¸°</button>
    </div>

    <div class="admin-box">
        <div style="font-weight:bold; margin-bottom:10px;">ğŸ—‘ï¸ ë‹¨ì–´ ì‚­ì œ</div>
        <input type="text" id="delEng" class="admin-input" placeholder="ì‚­ì œí•  ì˜ë‹¨ì–´">
        <button onclick="manageWord('delete')" style="width:100%; padding:15px; background:var(--fcl-red); color:white; border:none; border-radius:8px; font-weight:bold;">ì‹œíŠ¸ì—ì„œ ì‚­ì œ</button>
    </div>

    <button onclick="closeAdmin()" style="width:100%; padding:15px; background:#666; color:white; border:none; border-radius:8px; font-weight:bold;">ê´€ë¦¬ì ëª¨ë“œ ì¢…ë£Œ</button>
</div>

<script>
    const adminPw = "5857";
    const MASTER_URL = "ì—¬ê¸°ì—_ìƒˆë¡œìš´_ìŠ¤í¬ë¦½íŠ¸_URL_ì…ë ¥"; 

    let words = [];
    let checked = JSON.parse(localStorage.getItem('fcl_chk_v2')) || {};
    let isHidden = false;
    let isFocus = false;
    let synth = window.speechSynthesis;
    let unlocked = false;

    async function initApp() {
        loadData();
    }

    async function loadData() {
        const disp = document.getElementById('display');
        disp.innerHTML = "<p style='text-align:center; padding:50px;'>ë°ì´í„° ë™ê¸°í™” ì¤‘...</p>";
        try {
            const res = await fetch(MASTER_URL);
            words = await res.json();
            render();
        } catch(e) { disp.innerHTML = "ë¡œë“œ ì‹¤íŒ¨: URLì„ í™•ì¸í•˜ì„¸ìš”."; }
    }

    function render(targetData = null) {
        const disp = document.getElementById('display');
        let target = targetData || (isFocus ? words.filter(w => checked[w.english]) : words);
        
        disp.innerHTML = target.map(w => `
            <div class="word-item">
                <div class="check ${checked[w.english]?'active':''}" onclick="toggleCheck('${w.english}')"></div>
                <div class="eng-box" onclick="play('${w.english.replace(/'/g,"")}')">
                    <span class="eng">${w.english}</span>
                    <span class="pro">${w.pronunciation}</span>
                </div>
                <div class="kor ${isHidden?'hidden':''}" onclick="this.classList.toggle('hidden')">${w.korean}</div>
            </div>
        `).join('');
    }

    function toggleCheck(id) {
        checked[id] = !checked[id];
        localStorage.setItem('fcl_chk_v2', JSON.stringify(checked));
        render();
    }

    function toggleShuffle() {
        const shuffled = [...words].sort(() => Math.random() - 0.5);
        render(shuffled);
    }

    function toggleHide() { isHidden = !isHidden; render(); }
    function toggleFocus() {
        isFocus = !isFocus;
        document.getElementById('focusBtn').innerText = isFocus ? "ì „ì²´ ë³´ê¸°" : "ì§‘ì¤‘ ì•”ê¸°";
        render();
    }

    function askAdmin() {
        if(prompt("ë¹„ë°€ë²ˆí˜¸") === adminPw) {
            updateStats();
            document.getElementById('adminPanel').style.display = 'block';
        }
    }

    async function updateStats() {
        const res = await fetch(MASTER_URL + "?action=getStats");
        const count = await res.text();
        document.getElementById('statBox').innerText = `ì´ ${count}ê°œì˜ ë‹¨ì–´`;
    }

    async function manageWord(action) {
        let payload = { pw: adminPw, action: action };
        
        if(action === 'add') {
            payload.english = document.getElementById('addEng').value;
            payload.pronunciation = document.getElementById('addPro').value;
            payload.korean = document.getElementById('addKor').value;
        } else if(action === 'modify') {
            payload.oldWord = document.getElementById('oldName').value;
            payload.newWord = document.getElementById('newName').value;
        } else if(action === 'delete') {
            payload.english = document.getElementById('delEng').value;
        }

        await fetch(MASTER_URL, { method: "POST", body: JSON.stringify(payload) });
        alert("ì²˜ë¦¬ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.");
        location.reload();
    }

    function closeAdmin() { document.getElementById('adminPanel').style.display = 'none'; }
    function unlockAudio() { if(!unlocked) { synth.speak(new SpeechSynthesisUtterance("")); unlocked = true; } }
    
    function play(t) {
        synth.cancel();
        const m = new SpeechSynthesisUtterance(t);
        m.lang = 'en-US';
        m.rate = parseFloat(document.getElementById('speechRate').value);
        synth.speak(m);
    }

    initApp();
</script>
</body>
</html>